(()=>{var x="/product",O=5,k=document.querySelector(".header_nav_order_nb_text"),f=document.querySelector(".order-menu"),_=f.querySelector(".order-menu_container"),b=document.querySelector(".header_nav_order"),L=document.querySelector(".order-menu_close"),D=document.querySelector(".products_grid"),c=[],d=[];function g(){let e=0;return d.forEach(t=>{e+=t.amount}),e}function m(){k.innerText=g()}function v(e){if(d.length>0)if(g()<O){let t=d.findIndex(n=>n.id===e);if(t>=0){let n=c.findIndex(o=>o.id===e);d[t].amount<c[n].stock?(d[t].amount++,m(),u()):p(`Pas assez d'article en stock (${c[n].stock} en stock)`)}else d.push({id:e,amount:1}),m(),u()}else p("Il y a trop d'articles dans votre panier (5 max)");else d.push({id:e,amount:1}),m(),u()}function S(e){let t=d.findIndex(n=>n.id===e);t>=0&&(d[t].amount>1?(d[t].amount--,m(),u()):C(e))}function C(e){let t=d.findIndex(n=>n.id===e);d.splice(t,1),m(),u()}function p(e){let t=i("div","alert"),n=i("div","alert_message");n.innerHTML=e,t.appendChild(n);let o=setTimeout(()=>{t.remove()},2e3);t.addEventListener("click",l=>{l.stopPropagation(),clearTimeout(o),t.remove()}),document.body.appendChild(t)}function i(e,...t){let n=document.createElement(e);return t.forEach(o=>{n.classList.add(o)}),n}function u(){if(_.innerHTML="",d.length>0)d.forEach((e,t)=>{let n=i("div","order-menu_item"),o=i("div","order-menu_item_del-btn");o.addEventListener("click",()=>{C(e.id)}),n.appendChild(o);let l=c.find(T=>T.id===e.id),s=i("p","order-menu_item_title");s.innerText=l.title,n.appendChild(s);let r=i("div","order-menu_item_nb"),a=i("div","order-menu_item_minus-btn");a.addEventListener("click",()=>{S(e.id)}),r.appendChild(a);let E=i("p","order-menu_item_nb_text");E.innerText=`x${e.amount}`,r.appendChild(E);let h=i("div","order-menu_item_plus-btn");h.addEventListener("click",()=>{v(e.id)}),r.appendChild(h),n.appendChild(r),_.appendChild(n)});else{let e=i("div","order-menu_item"),t=i("p","order-menu_item_title");t.innerText="Aucun article",e.appendChild(t),_.appendChild(e)}}function R(){f.classList.toggle("closed")}function U(){c.forEach(e=>{let t=i("div","products_grid_item"),n=i("div","products_grid_item_img");if(console.log(e.imgUrl),e.imgUrl||(e.imgUrl="default.svg"),n.setAttribute("style",`--img-url: url(/images/products/${e.imgUrl})`),e.stock>0){let a=i("div","products_grid_item_content_add");a.addEventListener("click",()=>{v(e.id)}),n.appendChild(a)}t.appendChild(n);let o=i("div","products_grid_item_content"),l=i("p","products_grid_item_content_title");l.innerText=e.title,o.appendChild(l);let s=i("p","products_grid_item_content_price");s.innerText=`${e.price} \u20AC`,o.appendChild(s);let r=i("p","products_grid_item_content_stock");r.innerText=`(${e.stock} en stock)`,o.appendChild(r),t.appendChild(o),D.appendChild(t)})}b.addEventListener("click",()=>{R()});L.addEventListener("click",()=>{R()});fetch(x).then(e=>e.json()).catch(function(e){console.log("Il y a eu un probl\xE8me avec l'op\xE9ration fetch: "+e.message),p("Erreur lors de la r\xE9cup\xE9ration de la liste des produits")}).then(e=>{c=c.concat(e),U()});})();
//# sourceMappingURL=script.js.map
