{
  "version": 3,
  "sources": ["src/scripts/script.js"],
  "sourcesContent": ["//---IMPORT---//\n\n\n//---VARIABLE---//\nconst PRODUCTS_URL = \"http://fragments/product\";\nconst ORDER_MAX = 5;\n\nconst ORDER_NB = document.querySelector(\".header_nav_order_nb_text\");\nconst ORDER_MENU = document.querySelector(\".order-menu\");\nconst ORDER_MENU_CONTAINER = ORDER_MENU.querySelector(\".order-menu_container\");\nconst ORDER_BTN = document.querySelector(\".header_nav_order\");\nconst ORDER_CLOSE_BTN = document.querySelector(\".order-menu_close\");\nconst PRODUCTS_GRID = document.querySelector(\".products_grid\");\n\nlet PRODUCTS = [];\nconst ORDER = [];\n\n//---FUNCTION---//\n/**\n * Get number of products in the order\n * @returns {number}\n */\nfunction getOrderNb(){\n    let n = 0;\n\n    ORDER.forEach((product) => {\n        n += product.amount;\n    });\n\n    return n;\n}\n/**\n * Update UI of the products number in the order\n */\nfunction updateOrderNbUI(){\n    ORDER_NB.innerText = getOrderNb();\n}\n\n/**\n * Add product to order list\n * @param {number} productId\n */\nfunction addProductToOrder(productId){\n    if(ORDER.length > 0){\n        if(getOrderNb() < ORDER_MAX){\n            // validate and get product id\n            const index = ORDER.findIndex(product => product.id === productId);\n\n            if(index >= 0){\n                // validate stock\n                const productIndex = PRODUCTS.findIndex(product => product.id === productId);\n\n                if(ORDER[index].amount < PRODUCTS[productIndex].stock){\n                    ORDER[index].amount++;\n\n                    updateOrderNbUI();\n                    createOrderMenuItems();\n                }else{\n                    pushMessage(`Pas assez d'article en stock (${PRODUCTS[productIndex].stock} en stock)`);\n                }\n            }else{\n                ORDER.push({\n                    id: productId,\n                    amount: 1\n                });\n\n                updateOrderNbUI();\n                createOrderMenuItems();\n            }\n        }else{\n            pushMessage(\"Il y a trop d'articles dans votre panier (5 max)\");\n        }\n    }else{\n        ORDER.push({\n            id: productId,\n            amount: 1\n        });\n\n        updateOrderNbUI();\n        createOrderMenuItems();\n    }\n}\n\n/**\n * Pull product to order list\n * @param {number} productId\n */\nfunction pullProductToOrder(productId){\n    // validate and get product id exist\n    const index = ORDER.findIndex(product => product.id === productId);\n\n    if(index >= 0){\n        // test stock\n\n        if(ORDER[index].amount > 1){\n            ORDER[index].amount--;\n\n            updateOrderNbUI();\n            createOrderMenuItems();\n        }else{\n            removeProductToOrder(productId);\n        }\n    }\n}\n\n/**\n * Remove product to order list\n * @param {number} productId \n */\n function removeProductToOrder(productId){\n    const index = ORDER.findIndex(product => product.id === productId);\n    ORDER.splice(index, 1);\n\n    updateOrderNbUI();\n    createOrderMenuItems();\n}\n\n/**\n * Push a alert message\n * @param {string} message \n */\nfunction pushMessage(message){\n    const alertEl = createHtmlElement(\"div\", \"alert\");\n\n        const messageEl = createHtmlElement(\"div\", \"alert_message\");\n        messageEl.innerHTML = message;\n        alertEl.appendChild(messageEl);\n\n    const timer = setTimeout(() => {\n        alertEl.remove();\n    }, 2000);\n\n    alertEl.addEventListener(\"click\", (e) => {\n        e.stopPropagation();\n\n        clearTimeout(timer);\n        alertEl.remove();\n    });\n\n    document.body.appendChild(alertEl);\n}\n\n/**\n * Create a HTML Element\n * @param {string} type \n * @param {string[]} classNames \n * @returns {HTMLElement}\n */\nfunction createHtmlElement(type, ...classNames){\n    const el = document.createElement(type);\n    classNames.forEach((className) => {\n        el.classList.add(className);\n    });\n\n    return el;\n}\n\nfunction createOrderMenuItems(){\n    ORDER_MENU_CONTAINER.innerHTML = \"\";\n\n    if(ORDER.length > 0){\n        ORDER.forEach((product, i) => {\n            const itemEl = createHtmlElement(\"div\", \"order-menu_item\");\n\n                const delEl = createHtmlElement(\"div\", \"order-menu_item_del-btn\");\n                delEl.addEventListener(\"click\", () => {\n\n                    removeProductToOrder(product.id);\n                    // itemEl.remove();\n                });\n                itemEl.appendChild(delEl);\n\n                const ProductRef = PRODUCTS.find(productRef => productRef.id === product.id);\n\n                const titleEl = createHtmlElement(\"p\", \"order-menu_item_title\");\n                titleEl.innerText = ProductRef.title;\n                itemEl.appendChild(titleEl);\n\n                const nbEl = createHtmlElement(\"div\", \"order-menu_item_nb\");\n\n                    const minusEl = createHtmlElement(\"div\", \"order-menu_item_minus-btn\");\n                        minusEl.addEventListener(\"click\", () => {\n                            pullProductToOrder(product.id);\n                        });\n                    nbEl.appendChild(minusEl);\n\n                    const nbTextEl = createHtmlElement(\"p\", \"order-menu_item_nb_text\");\n                    nbTextEl.innerText = `x${product.amount}`;\n                    nbEl.appendChild(nbTextEl);\n\n                    const plusEl = createHtmlElement(\"div\", \"order-menu_item_plus-btn\");\n                        plusEl.addEventListener(\"click\", () => {\n                            addProductToOrder(product.id);\n                        });\n                    nbEl.appendChild(plusEl);\n\n                itemEl.appendChild(nbEl);\n                \n            ORDER_MENU_CONTAINER.appendChild(itemEl);\n        });\n    }else{\n        const itemEl = createHtmlElement(\"div\", \"order-menu_item\");\n            const titleEl = createHtmlElement(\"p\", \"order-menu_item_title\");\n            titleEl.innerText = \"Aucun article\";\n            itemEl.appendChild(titleEl);\n        ORDER_MENU_CONTAINER.appendChild(itemEl);\n    }\n}\nfunction toggleShowOrderMenu(){\n    ORDER_MENU.classList.toggle(\"closed\");\n}\n\nfunction createProductsItems(){\n    PRODUCTS.forEach((product) => {\n        const itemEl = createHtmlElement(\"div\", \"products_grid_item\");\n\n            const imgEl = createHtmlElement(\"div\", \"products_grid_item_img\");\n            if(!product.img_url) product.img_url = \"/images/icon.svg\";\n            imgEl.setAttribute(\"style\", `--img-url: url(${product.img_url})`);\n                if(product.stock > 0){\n                    const addBtn = createHtmlElement(\"div\", \"products_grid_item_content_add\");\n                    addBtn.addEventListener(\"click\", () => {\n                        addProductToOrder(product.id);\n                    });\n                    imgEl.appendChild(addBtn);\n                }\n            itemEl.appendChild(imgEl);\n\n            const contentEl = createHtmlElement(\"div\", \"products_grid_item_content\");\n                const titleEl = createHtmlElement(\"p\", \"products_grid_item_content_title\");\n                titleEl.innerText = product.title;\n                contentEl.appendChild(titleEl);\n\n                const priceEl = createHtmlElement(\"p\", \"products_grid_item_content_price\");\n                priceEl.innerText = `${product.price} \u20AC`;\n                contentEl.appendChild(priceEl);\n\n                const stockEl = createHtmlElement(\"p\", \"products_grid_item_content_stock\");\n                stockEl.innerText = `(${product.stock} en stock)`;\n                contentEl.appendChild(stockEl);\n            itemEl.appendChild(contentEl);\n\n        PRODUCTS_GRID.appendChild(itemEl);\n    });\n}\n\n//---EVENT---//\nORDER_BTN.addEventListener(\"click\", () => {\n    toggleShowOrderMenu();\n});\nORDER_CLOSE_BTN.addEventListener(\"click\", () => {\n    toggleShowOrderMenu();\n});\n\n//---MAIN---//\n\nfetch(PRODUCTS_URL)\n.then(response => response.json())\n.catch(function(error) {\n    console.log('Il y a eu un probl\u00E8me avec l\\'op\u00E9ration fetch: ' + error.message);\n    pushMessage(\"Erreur lors de la r\u00E9cup\u00E9ration de la liste des produits\");\n})\n.then((data) => {\n    PRODUCTS = PRODUCTS.concat(data);\n\n    createProductsItems();\n});\n\n"],
  "mappings": "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",
  "names": []
}
